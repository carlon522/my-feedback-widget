<!DOCTYPE html>
<!-- index.html – turnkey landing / demo page for my‑feedback‑widget -->
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>my‑feedback‑widget ✱ Demo</title>

  <!-- Minimal styling so it looks decent without any build step -->
  <style>
    :root{
      --brand:#0070f3;
      --text:#222;
    }
    *{box-sizing:border-box;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}
    body,html{margin:0;height:100%;display:flex;flex-direction:column;color:var(--text)}
    header{background:var(--brand);color:#fff;padding:1rem}
    h1{margin:0;font-size:1.4rem;font-weight:600}
    p{margin:.35rem 0;font-size:.9rem}

    a.bookmarklet{
      display:inline-block;
      background:#fff;
      color:var(--brand);
      padding:.35rem .65rem;
      border-radius:4px;
      text-decoration:none;
      font-weight:600;
      box-shadow:0 1px 3px rgba(0,0,0,.15);
    }

    main{flex:1;display:flex;flex-direction:column;height:100%}
    #toolbar{display:flex;gap:.5rem;padding:.5rem;background:#f5f5f5;align-items:center;border-bottom:1px solid #ddd}
    #url{flex:1;padding:.5rem;border:1px solid #ccc;border-radius:4px;font-size:.9rem}
    #load{padding:.5rem 1rem;border:none;background:var(--brand);color:#fff;font-weight:600;border-radius:4px;cursor:pointer}
    #frame{border:none;width:100%;flex:1}

    footer{font-size:.75rem;text-align:center;padding:.5rem;background:#fafafa;color:#666;border-top:1px solid #eee}
  </style>

  <!-- Load *our* widget so visitors can annotate this page too -->
  <script src="feedbackWidget.js"></script>
</head>
<body>
  <header>
    <h1>my‑feedback‑widget</h1>
    <p>Drag the button below to your bookmarks bar. Click it on <em>any</em> site to enable Markup.</p>
    <p>
      <a class="bookmarklet" href="javascript:(()=>{const s=document.createElement('script');s.src='https://cdn.jsdelivr.net/gh/carlon522/my-feedback-widget/feedbackWidget.js?'+Date.now();document.head.appendChild(s);})();">Markup Bookmarklet</a>
    </p>
  </header>

  <main>
    <div id="toolbar">
      <input id="url" placeholder="https://example.com/page.html">
      <button id="load">Load</button>
    </div>
    <iframe id="frame" title="Preview"></iframe>
  </main>

  <footer>
    Pages that set <code>X‑Frame‑Options</code> or a restrictive CSP won’t load here – use the bookmarklet instead.
  </footer>

  <script>
    // Basic in‑page reviewer: loads a URL in the iframe and injects the widget
    const urlField = document.getElementById('url');
    const frame = document.getElementById('frame');
    document.getElementById('load').addEventListener('click', () => {
      if(!urlField.value) return alert('Enter a URL first');
      frame.src = urlField.value;
    });

    // When iframe loads, try to inject the widget (same‑origin only)
    frame.addEventListener('load', () => {
      try{
        const d = frame.contentDocument;
        if(d && !d.querySelector('script[data-fw]')){
          const s = d.createElement('script');
          s.src = 'https://cdn.jsdelivr.net/gh/carlon522/my-feedback-widget/feedbackWidget.js';
          s.dataset.fw = 1;
          d.head.appendChild(s);
        }
      }catch(e){
        console.warn('Cross‑origin frame – bookmarklet works instead', e);
      }
    });
  </script>
</body>
</html>
